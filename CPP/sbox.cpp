#include <iostream>
#include <string>
#include <vector>
#include <bitset>

const std::vector<std::vector<int>> sbox = {
    {0xE, 0x4, 0xD, 0x1, 0x2, 0xF, 0xB, 0x8, 0x3, 0xA, 0x6, 0xC, 0x5, 0x9, 0x0, 0x7},
    {0xE, 0x4, 0xD, 0x1, 0x2, 0xF, 0xB, 0x8, 0x3, 0xA, 0x6, 0xC, 0x5, 0x9, 0x0, 0x7},
    {0xE, 0x4, 0xD, 0x1, 0x2, 0xF, 0xB, 0x8, 0x3, 0xA, 0x6, 0xC, 0x5, 0x9, 0x0, 0x7},
    {0xE, 0x4, 0xD, 0x1, 0x2, 0xF, 0xB, 0x8, 0x3, 0xA, 0x6, 0xC, 0x5, 0x9, 0x0, 0x7}
    
};

std::string sboxSubstitution(const std::string &input)
{
    if (input.length() % 6 != 0)
    {
        return "";
    }

    std::string result = "";
    for (size_t i = 0; i < input.length(); i += 6)
    {
        std::string blockStr = input.substr(i, 6);
        int blockInt = std::stoi(blockStr, nullptr, 2);
        int row = (((blockInt >> 4) & 0x02) | (blockInt & 0x01));
        int col = ((blockInt >> 1) & 0x0F);
        int sboxValue = sbox[row][col];
        result += std::bitset<4>(sboxValue).to_string();
    }

    return result;
}

int main()
{
    std::string plaintext = "110011001100";
    std::string ciphertext = sboxSubstitution(plaintext);

    std::cout << "Plaintext: " << plaintext << std::endl;
    std::cout << "Ciphertext: " << ciphertext << std::endl;

    return 0;
}
